# 이용자 인증정보 재사용 점검 결과

## 점검 항목
- 이용자 인증정보 재사용

## 진단 결과
- 취약

## 점검 목적
- 로그아웃 또는 만료된 세션·토큰이 동일 값으로 재사용되지 않도록 무효화가 수행되는지 확인함

## 보안 위협
- 탈취된 토큰을 장기간 사용하거나 세션 고정 공격을 통해 계정에 상주할 수 있음

## 판단 기준
- **양호**: 로그아웃, 비밀번호 변경, 만료 시간 경과 시 기존 토큰으로 요청하면 즉시 거부됨
- **취약**: 로그아웃 후에도 같은 토큰으로 정상 응답이 나오거나 만료 시간이 지나도 계속 사용 가능함

## 조치 방법
- 서버는 세션 저장소에서 토큰을 폐기하고 Refresh 토큰의 유효 기간을 제한할 것  
- 앱은 로그아웃 시 로컬에 저장된 토큰을 삭제하고, 401/419 응답 수신 시 재인증을 요구하도록 구성할 것

## 진단 세부 사항
- JWT 기반 인증을 사용하지만 로그아웃 후에도 기존 토큰이 계속 유효함  
- `MemberController.logout()`은 성공 메시지만 반환하며 서버 측에서 토큰 폐기·블랙리스트 처리를 하지 않음  
- 탈취되거나 저장된 토큰이 반복 사용될 수 있음

### 재현 절차
1. `POST /api/member/login` 응답에서 발급된 `token` 값을 복사함  
   ![Step1](./evidence/reuse_token_step1_login.png "로그인 응답에서 토큰 추출")
2. 복사한 토큰으로 `GET /api/member/info` 요청을 전송하고 200 응답을 확인함  
   ![Step2](./evidence/reuse_token_step2_info.png "토큰으로 회원 정보 조회 성공")
3. `POST /api/member/logout`을 호출해 로그아웃한 뒤 동일한 `GET /api/member/info` 요청을 다시 전송함  
   ![Step3](./evidence/reuse_token_step3_logout.png "로그아웃 요청")
4. 여전히 200 응답과 함께 사용자 정보가 조회되며, 동일 토큰으로 주문 조회·포인트 변경 등 보호 API도 모두 성공함  
   ![Step4](./evidence/reuse_token_step4_success.png "로그아웃 후에도 토큰 재사용 성공")

## 영향
- 사용자가 로그아웃했더라도 탈취된 토큰으로 계정 접근이 계속 가능함  
- 토큰 유출 시 주문·포인트 조작 및 계정 탈취가 발생할 수 있음  
- 사용자가 다른 기기에서 로그아웃해도 세션 종료가 보장되지 않아 위험함

## 개선 권고
- 로그아웃 시 서버에서 JWT를 블랙리스트에 등록하거나 세션 스토리지에서 무효화할 것  
- Refresh 토큰의 유효 기간을 짧게 설정하고, 사용 시마다 재검증 및 로테이션을 수행할 것  
- 앱은 로그아웃 시 로컬 저장소의 토큰을 삭제하고 401/419 응답 발생 시 재인증을 요구하도록 구현할 것  
- 토큰 유출을 대비해 계정 활동 로그와 알림을 강화하고 이상 사용을 탐지할 것
