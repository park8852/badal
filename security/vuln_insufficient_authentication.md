# 불충분한 이용자 인증 점검 결과

## 점검 항목
- 불충분한 이용자 인증

## 진단 결과
- 취약

## 점검 목적
- 민감 기능/API 호출 전에 인증 여부를 강제로 확인하고 있는지 평가함

## 보안 위협
- 인증 없이 주문 조회, 포인트 변경 등 민감 기능을 수행해 정보 유출·거래 조작이 발생할 수 있음

## 판단 기준
- **양호**: 인증 토큰이 없거나 만료된 경우 401/403을 반환하고 기능을 실행하지 않음
- **취약**: 인증 없이도 민감 API가 정상 응답을 반환함

## 조치 방법
- 모든 보호 엔드포인트에 인증 필터를 적용하고 토큰 유효성·만료를 검사할 것  
- 앱은 인증 상태를 지속 확인하며 미인증 시 로그인 화면으로 전환할 것

## 진단 세부 사항
- 주문 관리 API 중 일부가 로그인 여부를 확인하지 않음  
- `OrderController.update()`와 `OrderController.delete()`는 `Authorization` 헤더를 받지만 `jwtUtil.auth()`를 호출하지 않고 바로 서비스 로직을 실행함  
- 비로그인 사용자가 주문 수정·삭제 요청을 보내도 성공함

### 재현 절차
1. 로그인 없이 `GET /api/order/delete/{id}` 또는 `POST /api/order/update` 요청을 전송함  
   ![Step1](./evidence/insufficient_auth_step1_request.png "Authorization 헤더 없이 주문 삭제 요청")
2. 401/403이 아닌 200 응답이 내려오고 주문 데이터가 실제로 삭제·수정되는 것을 확인함  
   ![Step2](./evidence/insufficient_auth_step2_response.png "미인증 상태에서도 성공 응답")

## 영향
- 인증 없이 주문 데이터를 삭제·조작할 수 있어 정상 사용자 주문이 임의로 사라지거나 값이 변조될 수 있음  
- 자동화된 공격자가 모든 주문을 반복 삭제해 서비스 마비를 유발할 수 있음

## 개선 권고
- `OrderController.update`·`delete` 등 모든 민감 엔드포인트에서 `jwtUtil.auth()`를 호출해 토큰이 유효한지 검증할 것  
- 인증 실패 시 즉시 401/403을 반환하고, 로그에 경고를 남겨 이상 접근을 탐지할 것  
- 앱에서는 인증 체크를 주기적으로 수행하고, 토큰 만료·누락 시 로그인 화면으로 강제 이동할 것
