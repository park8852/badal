# 거래시 소유주 확인 여부 점검 결과

## 점검 항목
- 거래시 소유주 확인 여부

## 진단 결과
- 취약

## 점검 목적
- 거래(결제, 출금, 주문 등)를 요청한 사용자가 실제 계정·계좌 소유자인지 추가 인증 절차를 거치는지 점검함

## 보안 위협
- 세션 탈취 또는 기기 도난 시 공격자가 계정 정보만으로 타인의 결제나 포인트 전환을 수행할 수 있음  
- 2차 인증이 없다면 금전적 피해가 발생할 수 있음

## 판단 기준
- **양호**: 거래 실행 전 비밀번호 재입력, OTP, 생체 인증 등 본인 확인 절차가 수행됨
- **취약**: 로그인 세션만 유지되면 별도의 검증 없이 민감 거래가 진행됨

## 조치 방법
- 금액이나 위험도에 따라 2차 인증(OTP, SMS, FIDO, PIN 등)을 요구할 것  
- 거래 결과를 실시간으로 사용자에게 통지하여 거래 내용을 확인할 수 있도록 구성할 것

## 진단 세부 사항
- `MemberController.addPoint()`는 비밀번호 재입력, OTP, PIN 등 추가 본인 확인 없이 JWT만 검증함  
- `OrderController.create()` 역시 추가 인증 절차가 없어 탈취된 토큰만으로 주문이 가능함  
- 민감 거래 전체가 단순 JWT 인증만 거친 뒤 실행되므로 토큰 탈취 또는 방치된 세션으로 거래 수행 가능

### 재현 절차 (Burp Repeater 활용)
1. Burp 프록시를 설정하고 앱에서 로그인하여 JWT 토큰을 확보함  
   ![Step1](./evidence/owner_verification_step1_login.png "로그인 패킷 캡처")  
2. 포인트 충전 요청(`POST /api/member/point/add`)을 캡처해 Burp Repeater로 전송함  
   ![Step2](./evidence/owner_verification_step2_request.png "포인트 충전 요청 캡처")  
3. 앱을 로그아웃하거나 백그라운드로 둔 상태에서 동일 요청을 Repeater에서 반복 전송함  
   ![Step3](./evidence/owner_verification_step3_repeat.png "반복 전송")  
4. 매번 “포인트 충전 완료” 응답과 함께 포인트가 누적 증가함 → 추가 인증 절차 없이 토큰만으로 거래 가능  
   ![Step4](./evidence/owner_verification_step4_result.png "포인트 증가 결과")

## 영향
- 공격자는 탈취한 JWT로 타인의 포인트를 충전하거나 주문을 생성할 수 있음  
- 금전적 피해 및 계정 임의 사용, 사기성 거래 발생 가능

## 개선 권고
- 금액·거래 종류별로 비밀번호 재입력, OTP, FIDO 등 추가 본인 확인 절차를 도입할 것  
- 민감 거래 요청에 일회성 서명 또는 멱등 키를 포함해 다른 환경에서 재사용되지 않도록 제한할 것  
- 거래 발생 시 즉시 사용자에게 알림(Push/SMS/Email)을 제공하여 이상 거래를 빠르게 인지하도록 구성할 것
